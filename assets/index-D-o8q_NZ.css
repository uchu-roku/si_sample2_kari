:root{--bg:#f3f6fb;--panel:#fff;--ink:#14202e;--muted:#657487;--primary:#2aa7ff;--primary-ink:#0f4870;--danger:#ff5a6b;--ring:#2aa7ff;--radius:14px;--shadow: 0 10px 24px rgba(17,25,40,.08), 0 2px 8px rgba(17,25,40,.06);--gap:12px}html,body,#map{height:100%}body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Noto Sans JP,sans-serif;letter-spacing:.01em}.side{position:absolute;top:72px;right:16px;z-index:1000;width:380px;display:flex;flex-direction:column;gap:var(--gap);bottom:16px;max-height:calc(100vh - 88px);overflow:auto}.toolbar-top{position:absolute;top:16px;right:16px;display:flex;gap:8px;align-items:center;z-index:1000}.icon-btn{border:0;background:#fff;border-radius:10px;padding:8px 10px;box-shadow:var(--shadow);cursor:pointer}.icon-btn.danger{color:#8f1b2a}.switch{display:inline-flex;gap:6px;align-items:center;font-size:12px;color:var(--muted)}.switch input{accent-color:var(--primary)}.card{background:var(--panel);border-radius:var(--radius);box-shadow:var(--shadow);padding:12px 12px 14px}.card-h{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.card-t{font-weight:700}.card-actions{display:flex;gap:6px}.dropzone{border-radius:14px;background:linear-gradient(#f9fbff,#f1f6ff);padding:10px;margin-bottom:10px;box-shadow:var(--shadow)}.dropzone .dz-body{display:flex;align-items:center;justify-content:space-between;gap:8px}.dropzone strong{font-weight:700}.dropzone small{color:var(--muted)}.dropzone.highlight{outline:3px dashed color-mix(in srgb,var(--ring) 45%,transparent)}.progress{position:relative;height:8px;background:#e5eef7;border-radius:99px;margin-top:8px}.progress .bar{height:100%;background:linear-gradient(90deg,#bfe6ff,#2aa7ff);border-radius:99px}.progress .pct{position:absolute;top:-22px;right:0;color:var(--muted);font-size:12px}.layer-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:6px;max-height:220px;overflow:auto}.layer{display:grid;grid-template-columns:auto 1fr 90px auto;gap:8px;align-items:center;background:#fff;border-radius:12px;padding:8px 10px;box-shadow:inset 0 -1px #0000000f,var(--shadow)}.layer .eye{background:#fff;border:0;border-radius:10px;padding:6px;cursor:pointer}.layer .name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.layer .del{border:0;background:#ffe9ec;color:#7a1020;border-radius:10px;padding:6px 8px;cursor:pointer}.layer-list .empty{color:var(--muted);text-align:center;padding:8px}.row{display:grid;grid-template-columns:88px 1fr;align-items:center;gap:8px;margin:8px 0}.row.chk{grid-template-columns:1fr 1fr 1fr}.row.btns{grid-template-columns:1fr 1fr}.lbl{color:var(--muted)}.seg{display:inline-grid;grid-auto-flow:column;gap:6px}.seg input{display:none}.seg label{background:#fff;border-radius:999px;padding:6px 12px;box-shadow:var(--shadow);cursor:pointer}.seg input:checked+label{background:linear-gradient(#e9f6ff,#d7efff);color:var(--primary-ink);font-weight:700}.btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;cursor:pointer;box-shadow:inset 0 -1px #0000000f,var(--shadow);background:#fff;transition:.15s}.btn:focus-visible{outline:3px solid color-mix(in srgb,var(--ring) 50%,transparent)}.btn.primary{background:linear-gradient(#e9f6ff,#d7efff);color:var(--primary-ink);font-weight:700}.btn.ghost{background:#fff}.btn.danger{background:linear-gradient(#ffe9ec,#ffd9de);color:#7a1020}.btn.block{width:100%}.btn.sm{padding:6px 10px;border-radius:10px}input[type=range]{appearance:none;height:8px;border-radius:999px;background:#e5eef7}input[type=range]::-webkit-slider-thumb{appearance:none;width:18px;height:18px;border-radius:50%;background:#fff;box-shadow:0 2px 8px #0000002e,inset 0 0 0 2px #e6f3ff}input[type=range]::-moz-range-thumb{width:18px;height:18px;border:none;border-radius:50%;background:#fff}input[type=checkbox]{width:16px;height:16px;border-radius:4px;border:1px solid #c8d5e6;vertical-align:-2px;margin-right:6px}.leaflet-control-zoom a{border-radius:10px;box-shadow:var(--shadow);background:#fff;color:var(--ink)}.leaflet-bar a:hover{background:#f2f7ff}.status{position:absolute;bottom:12px;left:50%;transform:translate(-50%);background:#ffffffeb;-webkit-backdrop-filter:saturate(150%) blur(6px);backdrop-filter:saturate(150%) blur(6px);padding:6px 10px;border-radius:999px;box-shadow:var(--shadow);display:flex;gap:14px;color:var(--muted)}header{background:transparent;color:var(--ink);padding:14px 18px}header h1{margin:0;font-size:18px;letter-spacing:.02em}#app{display:flex;flex-direction:column;height:100vh}main{flex:1;display:flex;position:relative}#map{flex:1;z-index:1}.toast{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#000000d9;color:#fff;padding:12px 20px;border-radius:8px;z-index:9999;font-size:14px}.side.hidden{display:none}@media (max-width: 768px){#controls{max-width:200px;padding:10px}.operation-steps{flex-direction:column}.step{margin:2px 0}}#security-tools{border-top:1px solid #ccc;padding-top:15px;margin-top:15px}#clear-storage-btn{background-color:#dc3545;color:#fff;border:none;padding:8px 12px;border-radius:3px;cursor:pointer;margin-right:5px;margin-bottom:5px;font-size:16px;min-height:44px}#clear-storage-btn:hover{background-color:#c82333}#clear-storage-btn:focus{outline:2px solid #005fcc;outline-offset:2px}@media (prefers-contrast: high){.drop-area{border:3px solid #000;background-color:#fff;color:#000}button{border:2px solid #000;background-color:#fff;color:#000}button:hover,button:focus{background-color:#e0e0e0}.step{border:2px solid #000}.step.active,.step.completed{background-color:#000;color:#fff}#clear-storage-btn{border:2px solid #000;background-color:#fff;color:#000}#clear-storage-btn:hover,#clear-storage-btn:focus{background-color:#e0e0e0}}:root{--panel-w: 300px}.aside,.sidebar,.panel-right{width:var(--panel-w, 300px);flex:0 0 var(--panel-w, 300px);max-width:92vw}@media (max-width: 960px){:root{--panel-w: 280px}}:root{--panel-w: 320px}.sidebar,.side,.panel-right,.aside{width:var(--panel-w, 320px);flex:0 0 var(--panel-w, 320px);max-width:92vw}#layer-panel{position:absolute;z-index:1000;top:10px;left:10px;background:#fffffff2;border-radius:8px;padding:8px 10px;box-shadow:0 2px 8px #00000026;font:14px/1.35 system-ui,-apple-system,Segoe UI,sans-serif;min-width:220px}#layer-panel h2{margin:0 0 6px;font-size:14px;font-weight:600}#layerList{margin:0;padding:0;list-style:none;max-height:40vh;overflow:auto}.layer-row{display:grid;grid-template-columns:1fr 120px;gap:8px;align-items:center;padding:6px 0}.layer-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.opacity-slider{width:100%}.prop-table{border-collapse:collapse;width:100%}.prop-table th,.prop-table td{border:1px solid #e3e7ee;padding:4px 6px;font-size:12px;vertical-align:top}.prop-table th{background:#f6f8fb;text-align:left;width:38%}.leaflet-overlay-pane path.leaflet-interactive,.leaflet-overlay-pane svg .leaflet-interactive{pointer-events:auto!important}#layersCard{margin-top:10px}#layersCard .card-h{position:sticky;top:0;z-index:1;background:var(--card-bg,#fff);border-bottom:1px solid rgba(0,0,0,.08);padding:8px 12px}#layersCard .card-c{padding:8px 0;min-width:0}#layersCard #layerList{list-style:none;margin:0;padding:0 12px 12px;max-height:360px;overflow:auto}#layersCard #layerList .layer-row{display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:8px}#layersCard #layerList .layer-row:hover{background:#0000000d}#layersCard #layerList .layer-name{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#layersCard input.opacity-slider{width:120px}
